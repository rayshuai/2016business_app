bApp.directive("accountTitle",function(){return{restrict:"E",scope:!1,replace:!0,templateUrl:"directives/components/account/accountTitle.html"}}),bApp.directive("loginAccountInput",function(){return{restrict:"E",scope:!1,replace:!0,templateUrl:"directives/components/account/loginAccountInput.html"}}),bApp.directive("loginPassInput",function(){return{restrict:"E",scope:!1,replace:!0,templateUrl:"directives/components/account/loginPassInput.html"}}),bApp.directive("cardService",["registerInfo","$state",function(a,b){var c={icon:"payment",title:"实体卡服务",des:"Lorem ipsum dolor sit amet, consectetuer adipiscing elit.",url:"error.coding"},d={icon:"smartphone",title:"虚拟卡服务",des:"Lorem ipsum dolor sit amet, consectetuer adipiscing elit.",url:"account.register"},e=function(e,h,i){"card"==i.content?(e.con=c,h.addClass("service-card")):"nocard"==i.content&&(e.con=d,h.addClass("service-nocard")),e.choseService=function(){"card"==i.content?f():"nocard"==i.content&&g()},e.goRegister=function(){"card"==i.content?(a.service_type=2,b.go("error.coding")):"nocard"==i.content&&(a.service_type=1,b.go("account.register"))}},f=function(){h("service-card"),i("service-nocard")},g=function(){h("service-nocard"),i("service-card")},h=function(a){var b=angular.element(document.getElementsByClassName(a)[0]);b.find(".card-area").addClass("chosen"),b.find(".btn-area").addClass("show")},i=function(a){var b=angular.element(document.getElementsByClassName(a)[0]);b.find(".card-area").removeClass("chosen"),b.find(".btn-area").removeClass("show")};return{restrict:"E",replace:!0,scope:{},templateUrl:"directives/components/account/cardService.html",link:e}}]),bApp.directive("homeTitle",function(a){return{restrict:"E",scope:{},replace:!0,templateUrl:"directives/components/home/homeTitle.html",link:function(b){var c=JSON.parse(a.localStorage.store);b.owner=c.owner_name}}}),bApp.directive("sidebar",function(){return{restrict:"E",scope:!1,replace:!0,templateUrl:"directives/components/home/sidebar.html"}}),bApp.directive("clipBox",["$state",function(a){var b=function(a){var b,c,d,e=document.getElementById("clip-box"),f=e.getElementsByClassName("clip-area")[0],g=f.getElementsByClassName("point"),h=new Image,i=document.getElementById("clip-canvas"),j=i.getContext("2d"),k=0,l=0,m=600,n=400,o=document.getElementById("preview"),p=o.getContext("2d"),q=function(){var b=document.getElementById(a),c=null;b.addEventListener("change",function(){c=this.files[0];var a=new FileReader;h.onload=function(){r(),u()},a.onload=function(){h.src=this.result},a.readAsDataURL(c)})},r=function(){var a=h.width/600>h.height/400?h.width/600:h.height/400;b=a,m=Math.ceil(h.width/a),n=Math.ceil(h.height/a),m<600?(l=0,k=(600-m)/2):n<400&&(k=0,l=(400-n)/2),j.clearRect(0,0,600,400),j.drawImage(h,k,l,m,n),c=j.getImageData(k,l,m,n),d=j.getImageData(200,100,200,200),s(),j.putImageData(d,200,100),t(200,100,200,200)},s=function(){j.beginPath(),j.rect(0,0,600,400),j.fillStyle="rgba(60, 60, 60, 0.6)",j.fill()},t=function(a,c,d,e){a-=k,c-=l,console.log(a,c,d,e),a*=b,c*=b,d*=b,e*=b,p.drawImage(h,a,c,d,e,0,0,200,200)},u=function(){f.style.top="100px",f.style.left="200px",f.style.width="198px",f.style.height="198px",v()},v=function(){var a=!1,b=!1,c=!1,d=!1,h=!1,i=0,j=0,k=0,l=0;f.addEventListener("mousedown",function(b){a=!0,i=b.clientX,j=b.clientY}),g[0].addEventListener("mousedown",function(a){a.stopPropagation(),b=!0,i=a.clientX,j=a.clientY}),g[1].addEventListener("mousedown",function(a){a.stopPropagation(),c=!0,i=a.clientX,j=a.clientY}),g[2].addEventListener("mousedown",function(a){a.stopPropagation(),d=!0,i=a.clientX,j=a.clientY}),g[3].addEventListener("mousedown",function(a){a.stopPropagation(),h=!0,i=a.clientX,j=a.clientY}),e.addEventListener("mousemove",function(e){if(k=e.clientX-i,l=e.clientY-j,i=e.clientX,j=e.clientY,a)w(k,l);else if(b)x("lt",k,l);else if(c)x("rt",k,l);else if(d)x("rb",k,l);else{if(!h)return;x("lb",k,l)}}),document.addEventListener("mouseup",function(){a=!1,b=!1,c=!1,d=!1,h=!1})},w=function(a,b){var c=0,d=0,e=k,g=l,h=k+m,i=l+n,j=f.offsetWidth,o=f.offsetHeight;d=f.offsetTop+b,c=f.offsetLeft+a,d=Math.min(i-o,Math.max(g,d)),c=Math.min(h-j,Math.max(e,c)),f.style.top=d+"px",f.style.left=c+"px",y(c,d,j-2,o-2)},x=function(a,b,c){var d=2,e=k,g=l,h=k+m,i=l+n,j=f.offsetWidth,o=f.offsetHeight,p=f.offsetTop,q=f.offsetLeft,r=j,s=o,t=q,u=p,v=b;console.log(j,o,q,p),"lt"==a?p>g&&q>e&&(r=j-v,s=o-v,t=q+v,u=p+v):"rt"==a?p>g&&q<h-j+d&&(r=j+v,s=o+v,t=q,u=p-v):"rb"==a?q<h-j+d&&q<h-j+d&&(r=j+v,s=o+v,t=q,u=p):"lb"==a&&p<i-o+d&&q>e&&(r=j-v,s=o-v,t=q+v,u=p),f.style.left=t+"px",f.style.top=u+"px",f.style.width=r+"px",f.style.height=s+"px",y(t,u,r,s)},y=function(a,b,e,f){j.clearRect(0,0,600,400),j.putImageData(c,k,l),d=j.getImageData(a,b,e,f),s(),j.putImageData(d,a,b),t(a,b,e,f)};q()};return{restrict:"E",scope:!1,templateUrl:"directives/components/home/clipBox.html",replace:!0,link:function(a,c){new b("logo-file")}}}]),bApp.directive("memberClassify",function(){return{restrict:"E",scope:!1,replace:!0,templateUrl:"directives/components/home/memberClassify.html",link:function(a,b){$(b).find(".collapsible").collapsible()}}}),bApp.directive("memberChart",["memberFactory",function(a){return{restrict:"E",scope:!1,replace:!0,templateUrl:"directives/components/home/memberChart.html",link:function(b,c){a.initChart()}}}]),bApp.directive("moneyChart",["moneyChartFactory",function(a){return{restrict:"E",scope:!1,replace:!0,templateUrl:"directives/components/home/moneyChart.html",link:function(b,c){a.initChart()}}}]),bApp.directive("moneyOriginChart",["moneyOriginChartFactory",function(a){return{restrict:"E",scope:!1,replace:!0,templateUrl:"directives/components/home/moneyOriginChart.html",link:function(){a.initChart()}}}]),bApp.directive("formUpload",["$http",function(a){return{restrict:"A",scope:!1,link:function(b,c,d,e){var f=null,g="http://115.159.45.39/api/upload";c.bind("change",function(c){var d=new FormData;f=(c.srcElement||c.target).files[0],console.log(f),d.append("file",f),a.post(g,d,{transformRequest:angular.identity,headers:{"Content-Type":void 0}}).success(function(a){console.log(a),b.pic=a}).error(function(a,b){console.log(a,b)})})}}}]);